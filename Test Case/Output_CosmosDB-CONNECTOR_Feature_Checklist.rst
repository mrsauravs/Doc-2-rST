=============================
 OCF Connector for CosmosDB 
=============================

Overview
--------

The OCF connector for **CosmosDB **is available as a Zip file from `Alation's Connector Hub <https://connectorportal.alationcloud.com/>`__ (requires a login via the Alation Customer Portal). The connector file can be uploaded and installed in the Alation application. The connector is compiled together with the required database driver, so no additional effort is needed to procure and install the driver.

This connector should be used to catalog **CosmosDB **as a data source on Alation on-premise and Cloud Service instances. It extracts and catalogs such database objects as schemas, tables, and columns. After the metadata is extracted, it is represented in the data catalog as a hierarchy of *catalog pages* under the parent *data source*. Alation users can leverage the full catalog functionality to search for and find the extracted metadata, curate the corresponding catalog pages, create documentation about the data source, and exchange information about it.

Team
----

You may need the assistance of your database administrator to configure this data source.

* **CosmosDB **administrator:

    * Creates a service account for Alation.

    * Provides the connection information and the JDBC URI.

    * Provides the authentication information and assists in configuring the authentication.

* Alation Server Admin:

    * Ensures that Alation Connector Manager is installed and running or installs it.

    * Install the connector.

    * Creates and configures the **CosmosDB **data source in the catalog.

    * Performs initial extraction and prepares the data source for Alation users.

Scope
-----

The table below describes which metadata objects are extracted by this connector and which operations are supported.

+=====================================================================================================================================================================================================================================+==================================================================================================================================================================================+==============+
| Feature                                                                                                                                                                                                                             | Scope                                                                                                                                                                            | Availability |
+=====================================================================================================================================================================================================================================+==================================================================================================================================================================================+==============+
| Database version (Data Source)                                                                                                                                                                                                      | 23.0.8749                                                                                                                                                                        | Yes          |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Alation version                                                                                                                                                                                                                     | 2023.3                                                                                                                                                                           | Yes          |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Authentication                                                                                                                                                                                                                      |                                                                                                                                                                                  |              |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Basic                                                                                                                                                                                                                               | Authentication with user and Password                                                                                                                                            | No           |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Account Key                                                                                                                                                                                                                         | Authentication using Account Key                                                                                                                                                 | Yes          |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| AzureServicePrincipal                                                                                                                                                                                                               | Authenticate as an Azure Service Principal using a Client Secret                                                                                                                 | Yes          |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| SSL                                                                                                                                                                                                                                 | Connection over the TLS protocol                                                                                                                                                 | No           |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| LDAP                                                                                                                                                                                                                                | Authentication with the LDAP protocol                                                                                                                                            | No           |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| OAuth                                                                                                                                                                                                                               | Authentication with the OAuth 2.0 protocol.                                                                                                                                      | No           |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| SSO                                                                                                                                                                                                                                 | Authentication using an SSO flow through an IdP application                                                                                                                      | No           |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Note: We do support multiple Authentications and all the relevant properties are already exposed in the OCF connector.                                                                                                              |                                                                                                                                                                                  |              |
| Details of support authentications can be found here: https://cdn.cdata.com/help/EHJ/jdbc/pg_connectionj.htm                                                                                                                        |                                                                                                                                                                                  |              |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Metadata Extraction (MDE)                                                                                                                                                                                                           |                                                                                                                                                                                  |              |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Default MDE                                                                                                                                                                                                                         | Extraction of metadata  based on the JDBC driver methods in the connector code                                                                                                   | Yes          |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Custom query-based MDE                                                                                                                                                                                                              | Extraction of metadata based on extraction queries provided by user                                                                                                              | No           |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Extracted metadata objects                                                                                                                                                                                                          |                                                                                                                                                                                  |              |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Data Source                                                                                                                                                                                                                         | Data source object in Alation that is parent to the extracted metadata                                                                                                           | Yes          |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Schemas                                                                                                                                                                                                                             | List of schemas                                                                                                                                                                  | Yes          |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Tables                                                                                                                                                                                                                              | List of tables                                                                                                                                                                   | Yes          |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Columns                                                                                                                                                                                                                             | List of columns                                                                                                                                                                  | Yes          |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Column data types                                                                                                                                                                                                                   | Column data types                                                                                                                                                                | Yes          |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Views                                                                                                                                                                                                                               | List of views                                                                                                                                                                    | N/A          |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Source comments                                                                                                                                                                                                                     | Source comments                                                                                                                                                                  | N/A          |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Primary keys                                                                                                                                                                                                                        | Primary key information for extracted tables                                                                                                                                     | Yes          |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Foreign keys                                                                                                                                                                                                                        | Foreign key information for extracted tables                                                                                                                                     | N/A          |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Functions                                                                                                                                                                                                                           | Extraction of function metadata                                                                                                                                                  | N/A          |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Function definitions                                                                                                                                                                                                                | Extraction of function definition metadata                                                                                                                                       | N/A          |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Sampling and Profiling                                                                                                                                                                                                              |                                                                                                                                                                                  |              |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Table sampling                                                                                                                                                                                                                      | Retrieval of data samples from extracted tables                                                                                                                                  | Yes          |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Column sampling                                                                                                                                                                                                                     | Retrieval of data samples from extracted columns                                                                                                                                 | Yes          |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Deep column profiling                                                                                                                                                                                                               | On-demand profiling of specific columns with the calculation of value distribution stats                                                                                         | Yes          |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Dynamic profiling                                                                                                                                                                                                                   | On-demand table and column profiling by individual users who use their own database accounts to retrieve the profiles                                                            | Yes          |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Custom query-based table sampling                                                                                                                                                                                                   | Ability to use custom queries for sampling specific tables                                                                                                                       | Yes          |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Custom query-based column profiling                                                                                                                                                                                                 | Ability to use custom queries for profiling specific columns                                                                                                                     | Yes          |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Query Log Ingestion (QLI)                                                                                                                                                                                                           |                                                                                                                                                                                  |              |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Table-based QLI                                                                                                                                                                                                                     | Ingestion of query history based on a table that contains query history data                                                                                                     | No           |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Query-based QLI                                                                                                                                                                                                                     | Ingestion of query history based on a custom query history extraction query                                                                                                      | No           |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| JOINs and filters                                                                                                                                                                                                                   | Calculation of JOIN and filter information based on ingested query history                                                                                                       | No           |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Predicates                                                                                                                                                                                                                          | Ability to parse predicates in ingested queries                                                                                                                                  | No           |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Lineage                                                                                                                                                                                                                             |                                                                                                                                                                                  |              |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Automatic lineage generation                                                                                                                                                                                                        | Auto-calculation of lineage based on query history ingested from QLI, MDE, and Compose queries                                                                                   | No           |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Direct lineage                                                                                                                                                                                                                      | Extraction of lineage from system tables during MDE                                                                                                                              | No           |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Column-level lineage                                                                                                                                                                                                                | Extraction of lineages on the column level                                                                                                                                       | No           |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Compose                                                                                                                                                                                                                             |                                                                                                                                                                                  |              |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| On-premise instances                                                                                                                                                                                                                | Availability of Compose on on-premise instances of Alation                                                                                                                       | Yes          |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Alation Cloud Service instances                                                                                                                                                                                                     | Depending on your network configuration, you may be using Alation Agent to connect to your data source. Compose via Agent is supported from connector version <insert version>.  | No           |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| Basic authentication in Compose                                                                                                                                                                                                     | Authentication in Compose with username and password                                                                                                                             | Yes          |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+
| SSO authentication in Compose                                                                                                                                                                                                       | Describe what kind of SSO is supported                                                                                                                                           | No           |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+


Object Mapping
--------------

+==================+==============================+
| CosmosDB Concept | SQL Concept                  |
+==================+==============================+
| Container        | Table                        |
+------------------+------------------------------+
| Document         | Rows or Records within Table |
+------------------+------------------------------+


===================================================
 OCF Connector for CosmosDB: Install and Configure
===================================================

Network Connectivity
--------------------

Open outbound TCP port 443 to the **CosmosDB **server.

Service Account
---------------

Create a Service Account
~~~~~~~~~~~~~~~~~~~~~~~~

OCF does not have the concept of a Service Account. You can choose from the given auth scheme and authenticate with the Service.

Permissions for Metadata Extraction
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

*This depends only on the type of token that the customer is using.*

*Read more about this here:*

*https://cdn.cdata.com/help/EHJ/jdbc/RSBCosmosdb_p_TokenType.htm*

Permissions for Sampling and Profiling
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

*This depends only on the type of token that the customer is using.*

*Read more about this here:*

*https://cdn.cdata.com/help/EHJ/jdbc/RSBCosmosdb_p_TokenType.htm*

Permissions for Query Log Ingestion
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**QLI is not supported by this connector.**

Authentication
--------------

**All the Authentication support is listed here:**

https://cdn.cdata.com/help/EHJ/jdbc/RSBCosmosdb_p_AuthScheme.htm

JDBC URI
--------

You need to make use of the CData exposed connection property to build the URI or you can use the Connection properties displayed on General settings directly.

Note: You can use 1 out of 2 available options i.e. Either you can make use of JDBC URI or you can make use of listed connection properties.

Example Connection string: 

cosmosdb://AccountEndpoint=myAccountEndpoint;AccountKey=myAccountKey;

Query Log Ingestion Configuration
---------------------------------

**Not applicable to CosmosDB.**

Install the Connector
---------------------

Alation On-Premise
~~~~~~~~~~~~~~~~~~

**Important**

Installation of an OCF connector requires Alation Connector Manager to be installed as a prerequisite.

To install an OCF connector:

1. If this has not been done on your instance, install the Alation Connector Manager: `Install Alation Connector Manager <https://docs2.alationdata.com/en/latest/sources/OpenConnectorFramework/OCFInstallAlationConnectorManager.html>`__.

2. Make sure that the OCF connector Zip file that you received from Alation is available on your local machine.

3. Install the connector on the Connectors Dashboard page using the steps in `Manage  Connector Dashboard <https://docs2.alationdata.com/en/latest/sources/OpenConnectorFramework/ManageConnectors.html>`__.

Alation Cloud Service
~~~~~~~~~~~~~~~~~~~~~

**Note**

On Alation Cloud Service instances, Alation Connector Manager is available by default.

Depending on your network configuration, you may need to use Alation Agent to connect to databases.

Connection via Alation Agent
^^^^^^^^^^^^^^^^^^^^^^^^^^^^

1. Ensure that `Alation Agent <https://docs.alationdata.com/en/latest/cloud/AlationAgent/index.html>`__ is enabled on your Alation instance. If necessary, create a Support ticket with Alation for an Alation representative to enable the Alation Agent feature on your instance and to receive the Alation Agent installer.

2. `Install the Alation Agent <https://docs.alationdata.com/en/latest/cloud/AlationAgent/InstallingTheAlationAgent.html>`__.

3. `Install the OCF connector on Alation Agent <https://docs.alationdata.com/en/latest/cloud/AlationAgent/ConnectingTheAgentToDataSources.html>`__.

Connection Without Agent
^^^^^^^^^^^^^^^^^^^^^^^^

To install an OCF connector:

1. Ensure that the OCF connector Zip file is available on your local machine.

2. Install the connector on the Connectors Dashboard page using the steps in `Manage Connectors <https://docs.alationdata.com/en/latest/sources/OpenConnectorFramework/ManageConnectors.html>`__.

Create and Configure a New Data Source
--------------------------------------

In Alation, add a new data source:

1. Log in to Alation as a Server Admin.

2. Expand the **Apps** menu on the right of the main toolbar and select **Sources**.

3. On the **Sources** page, click **+Add** on the top right of the page and in the list that opens, click **Data Source**. This will open the **Add a Data Source** wizard.

4. On the first screen of the wizard, specify a name for your data source, assign more Data Source Admins, if necessary, and click the **Continue Setup** button on the bottom of the screen. The **Add a Data Source** screen will open.

5.  The only field that you need to populate on the **Add a Data Source** screen is **Database Type.** From the **Database Type **dropdown, select the connector name. You will be navigated to the Settings page of your new data source.

The name of this connector is Alation OCF Connector for CosmosDB.

Configuration
-------------

Access
~~~~~~

On the **Access** tab, set the data source visibility using these options:

* **Public Data Source**—The data source will be visible to all users of the catalog.

* **Private Data Source**—The data source will be visible to the users allowed access to the data source by Data Source Admins.

Add new Data Source Admin users in the **Data Source Admins** section.

General Settings
~~~~~~~~~~~~~~~~

Application Settings
^^^^^^^^^^^^^^^^^^^^

+===========+=============+===============+===============+
| Parameter | Description | Default value | Default value |
+===========+=============+===============+===============+
|           |             |               |               |
+-----------+-------------+---------------+---------------+
|           |             |               |               |
+-----------+-------------+---------------+---------------+
|           |             |               |               |
+-----------+-------------+---------------+---------------+
|           |             |               |               |
+-----------+-------------+---------------+---------------+
|           |             |               |               |
+-----------+-------------+---------------+---------------+


Connector Settings
^^^^^^^^^^^^^^^^^^

+===========+=============+===============+===============+
| Parameter | Description | Default value | Default value |
+===========+=============+===============+===============+
|           |             |               |               |
+-----------+-------------+---------------+---------------+
|           |             |               |               |
+-----------+-------------+---------------+---------------+
|           |             |               |               |
+-----------+-------------+---------------+---------------+
|           |             |               |               |
+-----------+-------------+---------------+---------------+
|           |             |               |               |
+-----------+-------------+---------------+---------------+


Please make use of this:

https://cdn.cdata.com/help/DDJ/jdbc/Connection.htm

Obfuscate Literals
^^^^^^^^^^^^^^^^^^

**Obfuscate Literals**—Enable this toggle to hide the details of the queries in the catalog page that are ingested via QLI or executed in Compose. This toggle is disabled by default.

Test Connection
^^^^^^^^^^^^^^^

Under **Test Connection**, click **Test** to validate network connectivity.

Logging Configuration
^^^^^^^^^^^^^^^^^^^^^

Logging is not similar in OCF as compared to CustomDB. You will not find logfile as a property for OCF, the reason is that OCF is a docker-based approach and we don't have a location to write the logs. 

Currently, the logs are getting appended as STDOUT inside the Docker logs. If the CData Support team asks for the logs, below are the steps that need to be followed for sharing the logs:

1. Find the Data Source Number of the Connector.

2. List all the containers using **docker ps -a**

3. View the logs using **docker logs <Container Name obtained from Step 2>**

4. Write the logs to some file, like **docker logs <Container Name> >> Filename.txt**

5. Send the FileName.txt to the CData Support team.

Metadata Extraction
-------------------

You can perform a default extraction or configure extraction based on custom queries.

* **Default extraction**—This type of MDE is based on default SQL queries that are built in the connector code.

**We only Support Default Extraction.**

* **Query-based extraction**—This type of MDE is based on custom SQL queries that can be provided by a Data Source Admin. See Query-Based` Extraction <#heading=h.nmf14n>`__ below.

**Query Based Extraction is not supported.**

Application Settings
~~~~~~~~~~~~~~~~~~~~

**Enable Raw Metadata Dump or Replay**—The options in this drop list can be used to dump the extracted metadata into files in order to debug extraction issues before ingesting the metadata into Alation. This feature can be used during testing in case there are issues with MDE. It breaks extraction into two steps: first, the extracted metadata is dumped into files and can be viewed; and second, it can be ingested from the files into Alation. It is recommended to keep this feature enabled only if debugging is required.

    * **Enable Raw Metadata Dump**—Select this option to save the extracted metadata into a folder for debugging purposes. The dumped data will be saved in four files (attribute.dump, function.dump, schema.dump, table.dump) in the folder opt/alation/site/tmp/ inside Alation shell.

    * **Enable Ingestion Replay**—Select this option to ingest the metadata from the dump files into Alation.

    * **Off**—Disable the **Raw Metadata Dump or Replay** feature. Extracted metadata will be ingested into Alation.

Connector Settings
~~~~~~~~~~~~~~~~~~

Under **Connector Settings**, you can configure query-based extraction, selective extraction, and scheduled extraction. If you do not specify any custom extraction queries, Alation will perform metadata extraction based on the default queries built in the connector.

Query Based Extraction
^^^^^^^^^^^^^^^^^^^^^^

Query-based extraction allows users to customize metadata extraction down to the level of specific metadata types, such as tables, columns, views, and some other types of database objects by using custom queries. Table, column, view, and function definition extraction is always enabled and cannot be disabled. Under the **Query Based Extraction** section of **Connector Settings**, you can enable or disable the extraction of additional metadata types, such as:

* System schemas

* Primary keys

* Foreign keys

* Indexes

* Functions

System schemas are disabled by default. All other metadata types are enabled by default. You can disable or enable the metadata types you want to extract by clearing or selecting the corresponding checkboxes.

Metadata Extraction Queries
^^^^^^^^^^^^^^^^^^^^^^^^^^^

To use query-based metadata extraction, you will need to write custom queries to extract the metadata. Alation expects that these queries conform to a specific structure and use some reserved identifiers. After providing custom queries, save them by clicking **Save** in this section.

**Query-based MDE is not supported.**

Selective Extraction
~~~~~~~~~~~~~~~~~~~~

Under **Selective Extraction**, you can select the schemas to include or exclude from extraction. Selective extraction settings are used to apply a filter to include or exclude a list of schemas.

To configure selective extraction:

1. Enable the **Selective Extraction** toggle if you want only a subset of schemas to be extracted.

2. Click **Get List of Schemas** to first fetch the list of schemas. The status of the Get Schemas action will be logged in the **Extraction Job Status** table at the bottom of the **Metadata Extraction** tab.

3. When schema synchronization is complete, a drop-down list of the schemas will become enabled.

4. Select one or more schemas as necessary.

5. Check if you are using the desired filter option. Available filter options are described below.

+============================+=====================================================================+
| Filter Option              | Description                                                         |
+============================+=====================================================================+
| Extract all Schemas except | Extract metadata from all Schemas except from the selected Schemas. |
+----------------------------+---------------------------------------------------------------------+
| Extract only these Schemas | Extract metadata only from the selected Schemas.                    |
+----------------------------+---------------------------------------------------------------------+


5. Click **Run Extraction Now** under **Automated and Manual Extraction** to extract metadata. The status of the extraction action is also logged in the **Extraction Job Status** table at the bottom of the page.

Automated and Manual Extraction
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

If you wish to automatically update the metadata extracted into the catalog, under **Automated and Manual Extraction**, turn on the **Enable Automated Extraction** switch and select the day and time when metadata must be extracted. The metadata extraction will be automatically scheduled to run on the selected schedule.

Compose
-------

Driver
~~~~~~

The required drivers for OCF data sources are compiled with the connector. The information about the driver is available on the **Compose** tab.

Export and Download
~~~~~~~~~~~~~~~~~~~

Under **Export and Download**, you can allow or disallow exporting and downloading of Compose query results for this data source. Exporting and downloading is enabled by default. Disable this toggle to disallow it.

Enabled in Compose
~~~~~~~~~~~~~~~~~~

By default, a data source is not enabled for use in Compose.

To allow use of Compose with this data source:

1. Before you enable Compose, specify the JDBC URI in the **Default Connection** field and click **Save**. Unless the default connection is provided, the **Enabled in Compose** toggle will remain disabled.
.. image:: image_0.png


2. Enable the **Enabled in Compose** toggle. This will reveal the **Compose Connections** information in the user interface.

3. You can either edit the default connection or add a new connection. To edit the default Compose connection, click the pencil icon for the **Default Connection** row of the **Compose Connections** table and in the **Edit Connection** dialog that opens, update the URL field as necessary. Click **Ok** in the dialog to save your changes.

4. To create a new connection for Compose, click **+Add** to the right of the **Compose Connections** section title and in the **Add Connection** dialog that opens, specify a Title (name) for your connection and a URL. Click **Add** in the dialog to save your changes.

In Compose, users will be able to choose a connection created here from the list of **Company Connections** in the **Connection Settings** dialog.

Compose Connection Sharing
^^^^^^^^^^^^^^^^^^^^^^^^^^

Select one of the **Compose Connection Sharing** options:

* **Shared connections across tabs**—This option lets users use the same connection across multiple Compose tabs. 

* **Separate connection per tab**—Users can use different connections for each Compose tab, which enables them to run multiple queries at the same time.

Enable User Impersonation
~~~~~~~~~~~~~~~~~~~~~~~~~

You can enable user impersonation for Compose. When user impersonation is enabled, users will connect to the data source with the impersonation account. All Compose queries by all Compose users will be executed against the database as queries from one impersonated user.

After enabling user impersonation, specify the username and password for the impersonation account. If applicable, enable the Enable Kerberos Authentication toggle and upload the appropriate keytab.

Data Uploader
~~~~~~~~~~~~~

Select a Data Uploader option based on the description below:

* **Use Global Setting (true)** or **Use Global Setting (false)**—Use the global setting option. The global setting is configured on the backend of the Alation server in the **alation_conf** parameter **alation.data_uploader.enabled**. Users are allowed to upload data if this flag is set to **True; **or if the flag is set to **False**, users are not allowed to upload data into any data source.

* **Enable for this data source**—Use this option to enable the data upload for this data source and override the global setting if the global setting in **alation_conf** if it is set to **false**.

* **Disable for this data source**—Use this option to disable the data upload for this data source and override the global setting in **alation_conf** if it is set to **True**.

SSO with Compose
~~~~~~~~~~~~~~~~


SSO on Compose is not supported.

Sampling and Profiling
----------------------

Sampling and profiling is supported. For details, see `Sampling and Profiling <https://docs.google.com/document/d/1mYHdvWKp0MKi2rsi-HbfnHfx9uvhe2swX4BCMT16eAo/edit>`__.

**Yes, both are supported**.

Query Log Ingestion
-------------------

**Not applicable to CosmosDB.**

Troubleshooting
---------------

Here it is:

`https://drive.google.com/file/d/1e4MKB4oFNmuQup0tieXZJFBgGrjwfNmK/view?usp=drive_link <https://drive.google.com/file/d/1e4MKB4oFNmuQup0tieXZJFBgGrjwfNmK/view?usp=drive_link>`__.. image:: image_1.png


